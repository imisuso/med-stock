import{r as b,u as V,j as z,f,c as r,k as i,a as e,b as y,o as n,d as w,t as d,w as c,e as a,v as U,F as x,g as v,l as k}from"./app-BAzGNY5n.js";import{A as S}from"./AppLayout-6pK9au1e.js";import{_ as N}from"./ModalUpToYou-CxscJv0q.js";import{_ as O}from"./PaginateMe-DJk_Ayzy.js";import{d as j,b as H}from"./buddhistEra-CTkOWY67.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Navbar-J242VETL.js";const D={key:0,class:"alert-banner fixed right-0 m-4 w-2/3 md:w-full max-w-sm"},E={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-green-300 shadow-xs rounded-md text-green-800 font-bold",title:"close",for:"banneralert"},F={key:1,class:"alert-banner fixed right-0 m-4 w-2/3 md:w-full max-w-sm"},T={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-yellow-200 shadow-xs rounded-md text-yellow-800 font-bold",title:"close",for:"banneralert"},P={key:2,class:"alert-banner fixed right-0 m-4 w-2/3 md:w-full max-w-sm"},R={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-red-200 shadow-xs rounded-md text-red-800 font-bold",title:"close",for:"banneralert"},q={class:"w-full p-4 flex-col justify-center bg-blue-100 rounded-md"},G={class:"w-full bg-blue-100 p-2 rounded-md"},I={class:"mt-3"},J={class:"mt-3"},K={class:"mt-3"},Q={key:0,class:"flex flex-col text-red-600 text-center"},W={key:1,for:"",class:"text-red-600"},X={key:2,for:"",class:"text-red-600"},Y={key:3,for:"",class:"text-red-600"},Z={key:4,for:"",class:"text-red-600"},ee={key:0},te={class:"bg-red-100 border-2 border-red-400 p-4 text-sm"},le={class:"w-full bg-blue-100 p-2 rounded-md"},se=["value"],oe={class:"w-full bg-blue-100 p-2 rounded-md"},de=["value"],ne={class:"mt-4 text-center"},re={class:""},ae=["value"],ie={class:"flex flex-col lg:flex-row"},ue={class:"bg-green-50 lg:bg-transparent lg:w-3/12"},me={class:"bg-green-50 lg:bg-transparent lg:w-3/12 lg:text-xs"},pe={class:""},fe={class:"bg-green-50 lg:bg-transparent lg:w-1/12"},ge={class:""},be={class:"bg-green-50 lg:bg-transparent lg:w-3/12 lg:text-xs"},we={class:"mx-2 text-xs"},ce={class:"flex bg-green-50 lg:bg-transparent lg:w-2/12"},xe=["href"],ve=["href"],_e={class:"text-gray-900 text-md font-medium"},he={for:"",class:"flex justify-start w-full text-sm"},ye={class:"flex justify-start w-full text-sm"},ke={class:"flex justify-start w-full text-sm"},je={class:"flex justify-start w-full text-sm"},ze={__name:"AddUser",props:{stocks:Array,units:Object,roles:Object,users:Object,user_change_logs:{type:Array}},setup(m){j.extend(H);const _=m,u=b(""),p=b(""),g=b(!1),l=V({sap_id:"",unit_id:0,role_id:0,employee_full_name:"",employee_division_name:"",employee_division_id:"",employee_position_name:"",employee_account_name:""}),L=(()=>{g.value=!0}),M=()=>{g.value=!1},B=()=>{let s={};return s=_.roles.find(t=>t.id===l.role_id),s.label},A=()=>{let s={};return s=_.units.find(t=>t.unitid===l.unit_id),s.unitname},C=(()=>{l.unit_id=0,l.role_id=0,l.employee_full_name="",l.employee_division_name="",l.employee_division_id="",l.employee_position_name="",l.employee_account_name="",axios.get(route("check-employee-status",{sap_id:l.sap_id})).then(s=>{u.value=s.data.status,p.value=s.data.login,s.data.status==="error_sap"&&(p.value=s.data.msg_error),s.data.status==="active"&&(l.employee_full_name=s.data.full_name,l.employee_division_name=s.data.division_name,l.employee_division_id=s.data.division_id,l.employee_position_name=s.data.position_name,l.employee_account_name=s.data.login)})}),$=(()=>{l.post(route("add-user"),{preserveState:!1,preserveScroll:!0})});return(s,t)=>(n(),z(S,null,{default:f(()=>[s.$page.props.flash.status==="success"?(n(),r("div",D,[t[6]||(t[6]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",E,[w(d(s.$page.props.flash.msg)+" ",1),t[5]||(t[5]=e("svg",{class:"fill-current text-white",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):i("",!0),s.$page.props.flash.status==="warning"?(n(),r("div",F,[t[8]||(t[8]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",T,[w(d(s.$page.props.flash.msg)+" ",1),t[7]||(t[7]=e("svg",{class:"fill-current text-red",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):i("",!0),s.$page.props.flash.status==="error"?(n(),r("div",P,[t[10]||(t[10]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",R,[w(d(s.$page.props.flash.msg)+" ",1),t[9]||(t[9]=e("svg",{class:"fill-current text-red",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):i("",!0),t[27]||(t[27]=e("div",{class:"w-full text-sm p-4 my-2 justify-center bg-red-100"},[e("p",{class:"underline underline-offset-1"},"คำแนะนำการเพิ่มผู้ใช้งาน"),e("p",null,"1.ระบุรหัสเจ้าหน้าที่ แล้วกดปุ่มตรวจสอบสถานะ แล้วตรวจสอบข้อมูลว่าเป็นบุคคลที่ต้องการเพิ่มเป็นผู้ใช้งานระบบนี้หรือไม่"),e("p",null,"2.ระบุหน่วยงานภายในภาควิชาฯที่บุคคลนี้สังกัด ซึ่งหากสังกัดหน่วยงานใดก็จะมีสิทธิเข้าถึงคลังวัสดุของหน่วยงานนั้นเท่านั้น "),e("p",null,"3.ระบุสิทธิการใช้งานระบบ (หากเป็นเจ้าหน้าที่สาขาที่ทำหน้าที่บันทึกตัดสต๊อก ให้ระบุสิทธิเป็น เจ้าหน้าที่)")],-1)),e("div",q,[t[19]||(t[19]=e("div",{class:"text-center text-lg font-bold"},[e("p",{class:"my-2"},"เพิ่ม/แก้ไข ผู้ใช้งาน")],-1)),e("div",G,[e("div",I,[t[11]||(t[11]=e("label",{class:"text-lg font-bold text-green-600"},"เพิ่มผู้ใช้งาน:",-1)),t[12]||(t[12]=e("label",null,"ระบุรหัสเจ้าหน้าที่ 8 หลัก(SAP)",-1)),e("button",{type:"submit",class:"inline-flex text-sm ml-3 bg-blue-500 hover:bg-blue-700 text-white py-1 px-6 border border-blue-500 rounded-xs",onClick:t[0]||(t[0]=o=>C())}," ตรวจสอบสถานะ ")]),e("div",J,[c(e("input",{type:"number",name:"",class:"w-full py-2 rounded-md","onUpdate:modelValue":t[1]||(t[1]=o=>a(l).sap_id=o)},null,512),[[U,a(l).sap_id]]),e("div",K,[u.value==="found_user_med_stock"?(n(),r("div",Q,[...t[13]||(t[13]=[e("label",{for:""}," สถานะ:พบรหัสเจ้าหน้าที่ตามที่ระบุในฐานข้อมูลผู้ใช้งานระบบวัสดุแล้ว ",-1)])])):i("",!0),u.value==="not_found"?(n(),r("label",W," สถานะ:ไม่พบรหัสเจ้าหน้าที่ตามที่ระบุ ")):i("",!0),u.value==="withdrawn"?(n(),r("label",X," สถานะ: "+d(p.value)+" เจ้าหน้าที่นี้ลาออกแล้ว ",1)):i("",!0),u.value==="error"?(n(),r("label",Y," สถานะ: error check username -->["+d(p.value)+"] ",1)):i("",!0),u.value==="error_sap"?(n(),r("label",Z," สถานะ: error -->["+d(p.value)+"] ",1)):i("",!0)])])]),u.value==="active"?(n(),r("div",ee,[e("div",te,[t[14]||(t[14]=e("div",{class:"flex"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-red-600"},[e("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})]),e("p",{class:"text-red-500 font-bold text-lg"},"กรุณาตรวจสอบความถูกต้องก่อนเพิ่มผู้ใช้งาน")],-1)),t[15]||(t[15]=e("label",{for:""},"ข้อมูลนี้ได้รับมาจากการเชื่อมโยงกับระบบของคณะฯ:",-1)),e("li",null,"ชื่อ: "+d(a(l).employee_full_name),1),e("li",null,"สังกัด: "+d(a(l).employee_division_name),1),e("li",null,"ตำแหน่ง: "+d(a(l).employee_position_name),1)]),e("div",le,[t[16]||(t[16]=e("div",{class:"mt-3"},[e("label",{for:""},"ระบุหน่วยงานที่สังกัด:")],-1)),c(e("select",{name:"",id:"",class:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight focus:outline-hidden focus:shadow-outline","onUpdate:modelValue":t[2]||(t[2]=o=>a(l).unit_id=o)},[(n(!0),r(x,null,v(m.units,o=>(n(),r("option",{key:o.id,value:o.unitid},d(o.unitname),9,se))),128))],512),[[k,a(l).unit_id]])]),e("div",oe,[t[17]||(t[17]=e("div",{class:"bg-blue-800 text-white text-xl text-center"},null,-1)),t[18]||(t[18]=e("div",{class:"mt-3"},[e("label",{for:""},"ระบุสิทธิการใช้งานระบบ:")],-1)),c(e("select",{name:"",id:"",class:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight focus:outline-hidden focus:shadow-outline","onUpdate:modelValue":t[3]||(t[3]=o=>a(l).role_id=o)},[(n(!0),r(x,null,v(m.roles,o=>(n(),r("option",{key:o.id,value:o.id},d(o.label),9,de))),128))],512),[[k,a(l).role_id]])]),e("div",ne,[e("div",null,[e("button",{type:"submit",class:"w-full p-3 text-md bg-green-500 hover:bg-green-700 text-white py-1 px-6 border border-green-500 rounded-xs shadow-md",onClick:t[4]||(t[4]=o=>L())}," บันทึก ")])])])):i("",!0)]),e("div",null,[t[20]||(t[20]=e("div",{class:"w-full my-2 text-center"},[e("label",{class:"text-lg font-bold text-blue-700"},"รายชื่อผู้ใช้งานทั้งหมด ")],-1)),y(O,{pagination:m.users},null,8,["pagination"]),t[21]||(t[21]=e("div",{class:"w-full border-b-4 border-gray-500 shadow-xs hidden lg:block"},[e("div",{class:"flex flex-col lg:flex-row"},[e("div",{class:"lg:w-3/12"}," ชื่อ "),e("div",{class:"lg:w-3/12"}," หน่วยงาน/สาขา "),e("div",{class:"lg:w-1/12"}," สถานะ "),e("div",{class:"lg:w-3/12"}," วันที่แก้ไขข้อมูลล่าสุด "),e("div",{class:"lg:w-2/12"}," :: ")])],-1))]),e("div",re,[(n(!0),r(x,null,v(m.users.data,(o,h)=>(n(),r("div",{key:h,value:o.id,class:"w-full border-b-2 my-2 border-gray-500 shadow-xs"},[e("div",ie,[e("div",ue,[e("div",null,d(m.users.from+h)+". "+d(o.name),1)]),e("div",me,[e("label",pe,d(o.unit.unitname),1)]),e("div",fe,[t[22]||(t[22]=e("label",{for:"",class:"lg:hidden"},"สถานะ:",-1)),e("label",ge,d(o.status_name),1)]),e("div",be,[t[23]||(t[23]=e("label",{for:"",class:"lg:hidden"},"วันที่แก้ไขข้อมูลล่าสุด:",-1)),e("label",we,d(a(j)(o.updated_at).locale("th").format("D MMM BBBB H:mm"))+" น. ",1)]),e("div",ce,[e("a",{href:s.route("show-detail-user",o.slug),class:"rounded-md shadow-md bg-yellow-200"},[...t[24]||(t[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 bg-yellow-200"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})],-1)])],8,xe),e("a",{href:s.route("get-user-log",o),class:"mx-2 rounded-md shadow-md bg-blue-300"},[...t[25]||(t[25]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,ve)])])],8,ae))),128))]),y(N,{isModalOpen:g.value},{header:f(()=>[...t[26]||(t[26]=[e("p",{class:"text-md font-bold text-red-600"},"คุณต้องการเพิ่มผู้ใช้งานนี้ใช่หรือไม่?",-1)])]),body:f(()=>[e("div",_e,[e("label",he," รหัสเจ้าหน้าที่: "+d(a(l).sap_id),1),e("label",ye," ชื่อเจ้าหน้าที่: "+d(a(l).employee_full_name),1),e("label",ke," หน่วย/สาขา:"+d(A()),1),e("label",je," กำหนดสิทธิเป็น:"+d(B()),1)])]),footer:f(()=>[e("div",{class:"w-full text-center md:block"},[e("button",{class:"mx-4 md:mb-0 bg-green-600 px-5 py-2 text-sm shadow-xs font-medium tracking-wider border text-white rounded-full hover:shadow-lg hover:bg-green-400",onClick:$}," ตกลง "),e("button",{class:"mx-4 md:mb-0 bg-red-500 border border-red-500 px-5 py-2 text-sm shadow-xs font-medium tracking-wider text-white rounded-full hover:shadow-lg hover:bg-red-600",onClick:M}," ยกเลิก ")])]),_:1},8,["isModalOpen"])]),_:1}))}};export{ze as default};
