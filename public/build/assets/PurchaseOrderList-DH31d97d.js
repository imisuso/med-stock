import{u as C,r as v,h as N,q as E,c as l,a as e,b as x,t as u,k as a,d as h,f as c,F as k,o as d,j as I,w as R,e as O,g as $,l as q,x as D}from"./app-BAzGNY5n.js";import{A as T}from"./AppLayout-6pK9au1e.js";import{_ as y}from"./ModalUpToYou-CxscJv0q.js";import{_ as U}from"./PaginateMe-DJk_Ayzy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Navbar-J242VETL.js";const G={class:"py-2 font-bold"},J={class:"flex flex-col space-y-2 md:flex-row md:space-y-0 md:justify-between"},K={class:"text-red-700 font-bold"},Q={class:"inline-flex px-2 text-sm font-semibold leading-5 text-red-900 bg-red-200 rounded-md"},W={key:0},X={key:1},Y={key:2},Z={key:3},ee={key:4},re={class:"flex"},te={class:"text-green-600 font-bold text-sm"},se={class:"flex flex-col space-y-2 md:flex-row md:space-y-0"},oe=["href"],de={key:4,class:"inline-flex text-sm md:ml-3 bg-red-300 hover:bg-red-700 py-1 px-2 border border-red-500 rounded-xs"},le=["href"],ne={class:"text-gray-900 text-md font-medium dark:text-white"},ae={for:""},ie={class:"text-gray-900 text-md font-medium dark:text-white"},ue={class:"flex justify-start w-full text-sm text-red-900"},ce={class:"text-gray-900 text-md font-medium dark:text-white"},pe={class:"flex justify-start w-full text-sm text-red-900"},he={__name:"ShowPurchaseOrder",props:{purchaseOrder:{type:Object,required:!0}},setup(t){const m=t,o=C({order_id:0,order_action:""}),b=v(0),p=v(!1),n=v(0),i=v(!1),g=v(0),w=v(!1),M=s=>{p.value=!0,n.value=s.budget,o.order_id=s.id,o.order_action="sended"},S=()=>{p.value=!1},_=s=>{p.value=!1,console.log(s),o.post(route("send-order-purchase",o.order_id),{preserveState:!1,preserveScroll:!0,onSuccess:r=>{console.log("success")},onError:r=>{console.log("error")},onFinish:r=>{console.log("finish")}})},j=s=>{i.value=!0,g.value=s.budget,o.order_id=s.id,o.order_action="approved"},B=()=>{i.value=!1},H=()=>{i.value=!1,console.log(o.order_id),console.log(o.order_action),o.post(route("approve-order-purchase",o.order_id),{preserveState:!1,preserveScroll:!0,onSuccess:s=>{console.log("success")},onError:s=>{console.log("error")},onFinish:s=>{console.log("finish")}})},L=s=>{console.log("confirmReturnPurchaseOrder"),w.value=!0,g.value=s.budget,o.order_id=s.id,o.order_action="created"},P=()=>{w.value=!1},V=()=>{i.value=!1,console.log(o.order_id),console.log(o.order_action),o.post(route("approve-order-purchase",o.order_id),{preserveState:!1,preserveScroll:!0,onSuccess:s=>{console.log("success")},onError:s=>{console.log("error")},onFinish:s=>{console.log("finish")}})};N(()=>{b.value=m.purchaseOrder.budget.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")});const z=s=>{console.log("editOrderPurchase"),console.log(s),Inertia.visit(route("get-edit-order-purchase"),{method:"post",data:{id:s}})},A=E(()=>{let s=["","มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],r=m.purchaseOrder.date_order.split("-"),f=s[parseInt(r[1])],F=parseInt(r[0])+543;return parseInt(r[2])+" "+f+" "+F});return(s,r)=>(d(),l(k,null,[e("div",G,u(t.purchaseOrder.stock.stockname),1),e("div",J,[e("p",K,"วันที่สั่งซื้อ: "+u(A.value),1),e("span",Q,[t.purchaseOrder.status=="created"?(d(),l("span",W,"ยังไม่ส่งไปภาคฯ")):a("",!0),t.purchaseOrder.status=="sended"?(d(),l("span",X,"รอภาคฯอนุมัติ")):a("",!0),t.purchaseOrder.status=="approved"?(d(),l("span",Y,"ภาคฯอนุมัติแล้ว")):a("",!0),t.purchaseOrder.status=="received"?(d(),l("span",Z,"ตรวจรับวัสดุแล้ว")):a("",!0),t.purchaseOrder.status=="received"&&t.purchaseOrder.timeline.create_by=="admin"?(d(),l("span",ee," บันทึกข้อมูลย้อนหลัง")):a("",!0)])]),e("div",null," ๑.ชื่อโครงการ:"+u(t.purchaseOrder.project_name)+" จำนวน "+u(t.purchaseOrder.items.length)+" รายการ",1),e("div",null," ๒.วงเงินงบประมาณ:"+u(b.value)+" บาท",1),e("div",re,[r[4]||(r[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule":"evenodd"})],-1)),e("p",te," คุณ"+u(t.purchaseOrder.user.name)+" ("+u(t.purchaseOrder.user.profile.division_name)+")",1),r[5]||(r[5]=e("p",{class:"px-2 text-gray-600 text-sm"},"ผู้บันทึกข้อมูล",-1))]),e("div",se,[e("a",{href:s.route("print-purchase-order-item",t.purchaseOrder.id),target:"blank",class:"inline-flex text-sm md:ml-3 bg-blue-200 border hover:bg-blue-500 border-blue-500 py-1 px-2 rounded-xs"},[...r[6]||(r[6]=[e("div",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z","clip-rule":"evenodd"})]),h(" พิมพ์รายการวัสดุสั่งซื้อ ")],-1)])],8,oe),t.purchaseOrder.status=="sended"&&s.$page.props.auth.user.profile.division_id==27?(d(),l("button",{key:0,onClick:r[0]||(r[0]=f=>j(t.purchaseOrder)),class:"inline-flex text-sm md:ml-3 bg-green-200 hover:bg-green-500 py-1 px-2 border border-green-500 rounded-xs"},[...r[7]||(r[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),h(" อนุมัติ ",-1)])])):a("",!0),t.purchaseOrder.status=="sended"&&s.$page.props.auth.user.profile.division_id==27?(d(),l("button",{key:1,onClick:r[1]||(r[1]=f=>L(t.purchaseOrder)),class:"inline-flex text-sm md:ml-3 bg-yellow-100 hover:bg-yellow-500 py-1 px-2 border border-yellow-500 rounded-xs"},[...r[8]||(r[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1),h(" ส่งคืนเพื่อแก้ไข ",-1)])])):a("",!0),t.purchaseOrder.status=="created"&&s.$page.props.auth.user.profile.division_id==t.purchaseOrder.unit_id?(d(),l("button",{key:2,onClick:r[2]||(r[2]=f=>M(t.purchaseOrder)),class:"inline-flex text-sm md:ml-3 bg-green-200 hover:bg-green-500 py-1 px-2 border border-green-500 rounded-xs"},[...r[9]||(r[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1),h(" ส่งเอกสารสั่งซื้อ ",-1)])])):a("",!0),t.purchaseOrder.status=="created"&&s.$page.props.auth.user.profile.division_id==t.purchaseOrder.unit_id?(d(),l("button",{key:3,class:"inline-flex text-sm md:ml-3 bg-yellow-200 hover:bg-yellow-700 py-1 px-2 border border-yellow-500 rounded-xs",onClick:r[3]||(r[3]=f=>z(t.purchaseOrder.id))},[...r[10]||(r[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),h(" แก้ไข ",-1)])])):a("",!0),t.purchaseOrder.status=="created"&&s.$page.props.auth.user.profile.division_id==t.purchaseOrder.unit_id?(d(),l("button",de,[...r[11]||(r[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),h(" ลบ ",-1)])])):a("",!0),t.purchaseOrder.status=="approved"&&s.$page.props.auth.user.profile.division_id==t.purchaseOrder.unit_id?(d(),l("a",{key:5,href:s.route("receive-order-purchase",t.purchaseOrder)},[...r[12]||(r[12]=[e("span",{class:"flex flex-row text-sm py-1 px-2 ml-3 leading-5 text-white bg-green-500 hover:bg-green-700 rounded-xs"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-2m-4-1v8m0 0l3-3m-3 3L9 8m-5 5h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293h3.172a1 1 0 00.707-.293l2.414-2.414a1 1 0 01.707-.293H20"})]),h(" ตรวจรับวัสดุ ")],-1)])],8,le)):a("",!0)]),x(y,{isModalOpen:p.value},{header:c(()=>[...r[13]||(r[13]=[e("p",{class:"text-md font-bold text-red-600"},"คุณต้องการส่งเอกสารใบสั่งซื้อวัสดุนี้ใช่หรือไม่?",-1)])]),body:c(()=>[e("div",ne,[e("label",ae,"วงเงินงบประมาณ "+u(n.value)+" บาท",1)])]),footer:c(()=>[e("div",{class:"w-full text-center md:block"},[e("button",{class:"mx-4 md:mb-0 bg-green-600 px-5 py-2 text-sm shadow-xs font-medium tracking-wider border text-white rounded-full hover:shadow-lg hover:bg-green-400",onClick:_}," ตกลง "),e("button",{class:"mx-4 md:mb-0 bg-red-500 border border-red-500 px-5 py-2 text-sm shadow-xs font-medium tracking-wider text-white rounded-full hover:shadow-lg hover:bg-red-600",onClick:S}," ยกเลิก ")])]),_:1},8,["isModalOpen"]),x(y,{isModalOpen:i.value},{header:c(()=>[...r[14]||(r[14]=[e("p",{class:"text-md font-bold text-red-600"},"คุณต้องการอนุมัติใบสั่งซื้อวัสดุนี้ใช่หรือไม่?",-1)])]),body:c(()=>[e("div",ie,[e("label",ue," วงเงินงบประมาณ "+u(g.value)+" บาท ",1)])]),footer:c(()=>[e("div",{class:"w-full text-center md:block"},[e("button",{class:"mx-4 md:mb-0 bg-green-600 px-5 py-2 text-sm shadow-xs font-medium tracking-wider border text-white rounded-full hover:shadow-lg hover:bg-green-400",onClick:H}," ตกลง "),e("button",{class:"mx-4 md:mb-0 bg-red-500 border border-red-500 px-5 py-2 text-sm shadow-xs font-medium tracking-wider text-white rounded-full hover:shadow-lg hover:bg-red-600",onClick:B}," ยกเลิก ")])]),_:1},8,["isModalOpen"]),x(y,{isModalOpen:w.value},{header:c(()=>[...r[15]||(r[15]=[e("p",{class:"text-md font-bold text-red-600"},"คุณต้องการส่งคืนใบสั่งซื้อวัสดุนี้ใช่หรือไม่?",-1)])]),body:c(()=>[e("div",ce,[e("label",pe," วงเงินงบประมาณ "+u(g.value)+" บาท ",1)])]),footer:c(()=>[e("div",{class:"w-full text-center md:block"},[e("button",{class:"mx-4 md:mb-0 bg-green-600 px-5 py-2 text-sm shadow-xs font-medium tracking-wider border text-white rounded-full hover:shadow-lg hover:bg-green-400",onClick:V}," ตกลง "),e("button",{class:"mx-4 md:mb-0 bg-red-500 border border-red-500 px-5 py-2 text-sm shadow-xs font-medium tracking-wider text-white rounded-full hover:shadow-lg hover:bg-red-600",onClick:P}," ยกเลิก ")])]),_:1},8,["isModalOpen"])],64))}},me={key:0,class:"alert-banner fixed right-0 m-2 w-2/3 md:w-full max-w-sm"},ge={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-green-300 shadow-xs rounded-md text-green-800 font-bold",title:"close",for:"banneralert"},ve={class:"w-full bg-blue-100 p-2 rounded-md"},fe={class:"bg-blue-800 text-white text-xl text-center"},xe={class:"flex flex-col mb-2 text-md font-bold text-gray-900"},be={class:"m-2"},we=["value"],ye={key:1,class:"flex flex-col p-2 bg-yellow-100"},ke={key:2,class:"w-full py-4"},Be={__name:"PurchaseOrderList",props:{years:{type:Object},year_selected:{type:Number},purchase_orders:{type:Object}},setup(t){const m=t;console.log("year_selected="+m.year_selected);const o=C({year_selected:m.year_selected?m.year_selected:""}),b=()=>{console.log("getListPurchase"),D.get(route("purchase-order-list"),{year:o.year_selected},{preserveState:!0,replace:!0})};return(p,n)=>(d(),I(T,null,{default:c(()=>[p.$page.props.flash.status==="success"?(d(),l("div",me,[n[2]||(n[2]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",ge,[h(u(p.$page.props.flash.msg)+" ",1),n[1]||(n[1]=e("svg",{class:"fill-current text-white",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):a("",!0),n[5]||(n[5]=e("div",{class:"w-full flex justify-center"},[e("label",{class:"text-lg font-bold"},"รายการใบสั่งซื้อ")],-1)),e("div",ve,[e("div",fe,u(p.$page.props.auth.user.profile.division_name),1)]),e("div",xe,[e("div",be,[n[3]||(n[3]=e("label",{for:""},"ระบุปีงบประมาณ:",-1)),R(e("select",{name:"",id:"","onUpdate:modelValue":n[0]||(n[0]=i=>O(o).year_selected=i),class:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight focus:outline-hidden focus:shadow-outline",onChange:b},[(d(!0),l(k,null,$(t.years,(i,g)=>(d(),l("option",{key:g,value:i},u(i+543),9,we))),128))],544),[[q,O(o).year_selected]])])]),p.$page.props.auth.user.profile.division_id<20?(d(),l("div",ye,[...n[4]||(n[4]=[e("label",{class:"font-bold text-red-500"},"ขั้นตอน/คำแนะนำ:(ให้ user ยืนยันขั้นตอนการทำงาน)",-1),e("label",null,"1.กดปุ่มส่งเอกสารสั่งซื้อ เพื่อส่งให้สำนักงานภาคฯ",-1),e("label",null,"2.หลังจากหัวหน้าภาคฯอนุมัติแล้ว จึงจะเห็นปุ่มตรวจรับวัสดุ ",-1),e("label",null,"3.เมื่อได้รับวัสดุแล้ว จึงมากดปุ่มตรวจรับวัสดุ ",-1)])])):a("",!0),t.purchase_orders?(d(),l("div",ke,[x(U,{pagination:t.purchase_orders},null,8,["pagination"]),(d(!0),l(k,null,$(t.purchase_orders.data,i=>(d(),l("div",{key:i.id,class:"m-2 p-2 bg-pink-50 border-b-2 border-pink-600 rounded-md shadow-md"},[x(he,{"purchase-order":i},null,8,["purchase-order"])]))),128))])):a("",!0)]),_:1}))}};export{Be as default};
