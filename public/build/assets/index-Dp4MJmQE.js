import{r as b,u as j,c as n,a as e,b as p,k as g,d as m,t as o,f as h,e as u,p as O,w as _,v as M,n as $,F as I,o as r,i as B,s as A,x as D,j as N,g as C,l as E,y as U}from"./app-BAzGNY5n.js";import{_ as Y}from"./ModalUpToYou-CxscJv0q.js";import{d as w,b as q}from"./buddhistEra-CTkOWY67.js";import{A as F}from"./AppLayout-6pK9au1e.js";import{_ as L}from"./PaginateMe-DJk_Ayzy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Navbar-J242VETL.js";const K={class:"w-full mt-2 border-2 border-gray-500 rounded-lg"},P={key:0,class:"flex bg-pink-200 overflow-hidden text-center bg-cover rounded-t"},T={key:1,class:"flex bg-blue-200 items-center overflow-hidden text-center bg-cover rounded-t"},H={class:"w-full leading-normal border-b border-l border-r border-gray-200 rounded-b lg:border-l-0 lg:border-t lg:border-gray-200 lg:rounded-b-none lg:rounded-r"},R={class:"mb-2"},G={class:"p-2 text-md font-bold text-gray-900"},J={for:"",class:"text-blue-600"},Q={class:"flex flex-col lg:flex-col mb-2 text-md font-bold text-gray-900"},W={class:"flex ml-2"},X={class:"ml-2 text-red-600"},Z={class:"inline-flex px-2 text-lg font-semibold leading-5 text-green-800 bg-green-100 rounded-full"},ee={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6 text-red-500"},te={class:"flex ml-2"},le={class:"ml-2 text-blue-600"},se={class:"flex ml-2"},oe={class:"ml-2 text-blue-600"},re={class:"flex ml-2"},ne={class:"ml-2 text-blue-600"},de={class:"flex ml-2"},ie={class:"ml-2 text-blue-600"},ae={class:"flex ml-2"},ue={class:"ml-2 text-blue-600"},ce={key:0,class:"flex flex-col lg:flex-row mb-2 text-md font-bold text-gray-900"},me={class:"m-2"},fe={class:"flex justify-start"},ge={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-red-600",viewBox:"0 0 20 20",fill:"currentColor"},ve={class:"m-2"},be={class:"flex justify-start"},xe={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-red-600",viewBox:"0 0 20 20",fill:"currentColor"},he=["max"],pe={class:"mx-2 text-center bg-red-600 text-sm text-white"},ke={key:0},we={key:1},_e={key:1,class:"flex flex-col lg:flex-row px-2 py-2"},ye={class:"text-gray-900 text-md font-medium"},Me={class:"mt-2"},Ie={__name:"CheckoutItem",props:{itemIndex:{type:Number},stockItem:{type:Object,required:!0},canAbility:{type:Object,required:!0}},setup(s){w.extend(q);const x=b(!1),c=b(!1),d=b(!1),f=b(""),a=b(!1),l=j({unit_checkout:0,date_checkout:w(new Date).locale("th").format("YYYY-MM-DD"),confirm_item_name:"",confirm_item_slug:"",confirm_item_date:"",confirm_item_count:""}),i=v=>v.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),y=v=>{if(l.date_checkout.length==0)return c.value=!0,f.value="กรุณาระบุวันที่เบิก",!1;if(c.value=!1,l.unit_checkout==0)return d.value=!0,f.value="กรุณาระบุจำนวน",!1;if(d.value=!1,Number.isInteger(l.unit_checkout))d.value=!1;else return d.value=!0,f.value="กรุณาระบุจำนวนที่เบิกวัสดุเป็นจำนวนเต็ม",!1;if(l.unit_checkout>v.item_balance)return d.value=!0,a.value=!0,f.value="จำนวนที่เบิกต้องไม่มากกว่าจำนวนคงเหลือ",!1;if(d.value=!1,a.value=!1,l.unit_checkout<0)return d.value=!0,a.value=!0,f.value="จำนวนที่เบิกต้องไม่เป็นจำนวนติดลบ",!1;d.value=!1,a.value=!1,x.value=!0,l.confirm_item_slug=v.slug,l.confirm_item_name=v.item_name,l.confirm_item_date=l.date_checkout,l.confirm_item_count=l.unit_checkout},z=()=>{x.value=!1},V=()=>{x.value=!1,l.post(route("checkout-stock-item"),{preserveState:!1,preserveScroll:!0,onError:v=>{console.log("error")}})},S=()=>(c.value=!0,f.value="กรุณาระบุวันที่โดยคลิ๊กที่รูปปฎิทิน",document.getElementById("dateCheckout").value="",!1);return(v,t)=>(r(),n(I,null,[e("div",K,[s.stockItem.status==1?(r(),n("div",P,[...t[3]||(t[3]=[e("div",null,[e("label",null,"สัญญาซื้อ")],-1)])])):(r(),n("div",T,[...t[4]||(t[4]=[e("div",null,[e("label",null,"ใบสั่งซื้อ")],-1)])])),e("div",H,[e("div",R,[e("div",G,[m(o(s.itemIndex+1)+". รหัสวัสดุ:"+o(s.stockItem.item_code)+" ",1),e("label",J,o(s.stockItem.item_name),1),m(" (หน่วย: "+o(s.stockItem.unit_count)+") ",1),p(u(O),{href:v.route("list-stock-item",s.stockItem.hashed_key)},{default:h(()=>[...t[5]||(t[5]=[e("span",{class:"inline-flex text-md font-semibold leading-5 text-green-800 bg-green-200 rounded-lg"}," ประวัติการรับเข้าและเบิกออก ",-1)])]),_:1},8,["href"])]),e("div",Q,[e("div",W,[t[8]||(t[8]=m(" จำนวนที่มี : ",-1)),e("p",X,[e("span",Z,[t[6]||(t[6]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)),m(" "+o(i(s.stockItem.item_balance)),1)])]),s.stockItem.item_balance<6?(r(),n("svg",ee,[...t[7]||(t[7]=[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"},null,-1)])])):g("",!0)]),e("div",te,[t[9]||(t[9]=m(" ราคาต่อหน่วย : ",-1)),e("p",le,o(i(s.stockItem.checkin_last.price))+" บาท ",1)]),e("div",se,[t[10]||(t[10]=m(" Pur.Order : ",-1)),e("p",oe,o(s.stockItem.checkin_last.pur_order),1)]),e("div",re,[t[11]||(t[11]=m(" ชื่อบริษัท : ",-1)),e("p",ne,o(s.stockItem.checkin_last.business_name),1)]),e("div",de,[t[12]||(t[12]=m(" วันหมดอายุ(Lot. ล่าสุด) : ",-1)),e("p",ie,o(u(w)(s.stockItem.checkin_last.date_expire).locale("th").format("D MMMM BBBB")),1)]),e("div",ae,[t[13]||(t[13]=m(" วันที่รับเข้า(Lot. ล่าสุด) : ",-1)),e("p",ue,o(u(w)(s.stockItem.checkin_last.date_action).locale("th").format("D MMMM BBBB")),1)])]),s.canAbility.checkout_item&&s.stockItem.item_balance!=0?(r(),n("div",ce,[e("div",me,[e("div",fe,[c.value?(r(),n("svg",ge,[...t[14]||(t[14]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])])):g("",!0),t[15]||(t[15]=e("label",null,"วันที่เบิก:",-1))]),e("div",null,[_(e("input",{type:"date",id:"dateCheckout","onUpdate:modelValue":t[0]||(t[0]=k=>u(l).date_checkout=k),class:$(["w-full bg-gray-300 px-12 py-2 border-2 rounded-md appearance-none focus:border-indigo-600 focus:ring-3 focus:ring-black/50 focus:ring-indigo-500",[c.value?"border-red-500 border-2 ":"border-gray-400"]]),onKeydown:S,readonly:""},null,34),[[M,u(l).date_checkout]])])]),e("div",ve,[e("div",be,[d.value?(r(),n("svg",xe,[...t[16]||(t[16]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])])):g("",!0),t[17]||(t[17]=e("label",{for:""},"จำนวน:",-1))]),e("div",null,[_(e("input",{type:"number",name:"",id:"",min:0,max:s.stockItem.item_balance,pattern:"[0-9]","onUpdate:modelValue":t[1]||(t[1]=k=>u(l).unit_checkout=k),class:$(["w-full px-12 py- border-2 rounded-md appearance-none focus:border-indigo-600 focus:ring-3 focus:ring-black/50 focus:ring-indigo-500",[d.value?"border-red-500 border-2 ":"border-gray-400"]])},null,10,he),[[M,u(l).unit_checkout]])])])])):g("",!0),e("div",pe,[c.value?(r(),n("label",ke,"!!! "+o(f.value)+" !!!",1)):g("",!0),d.value?(r(),n("label",we,"!!! "+o(f.value)+" !!!",1)):g("",!0)]),s.canAbility.checkout_item&&s.stockItem.item_balance!=0?(r(),n("div",_e,[e("button",{class:"flex justify-center px-4 py-1 text-sm text-white bg-green-600 rounded-md hover:bg-green-400 focus:outline-hidden",onClick:t[2]||(t[2]=k=>y(s.stockItem))},[...t[18]||(t[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1),m(" บันทึกการเบิก ",-1)])])])):g("",!0)])])]),p(Y,{isModalOpen:x.value},{header:h(()=>[...t[19]||(t[19]=[e("p",{class:"text-md font-bold text-red-600"},"คุณต้องการบันทึกการเบิกวัสดุรายการนี้ใช่หรือไม่?",-1)])]),body:h(()=>[e("div",ye,[e("p",Me,o(u(l).confirm_item_name)+" เบิกใช้วันที่ "+o(u(l).confirm_item_date)+" จำนวน "+o(u(l).confirm_item_count)+" ชิ้น",1)])]),footer:h(()=>[e("div",{class:"w-full text-center md:block"},[e("button",{class:"mx-4 md:mb-0 bg-green-600 px-5 py-2 text-sm shadow-xs font-medium tracking-wider border text-white rounded-full hover:shadow-lg hover:bg-green-400",onClick:V}," ตกลง "),e("button",{class:"mx-4 md:mb-0 bg-red-500 border border-red-500 px-5 py-2 text-sm shadow-xs font-medium tracking-wider text-white rounded-full hover:shadow-lg hover:bg-red-600",onClick:z}," ยกเลิก ")])]),_:1},8,["isModalOpen"])],64))}},$e={key:0,class:"alert-banner fixed right-0 m-2 w-5/6 md:w-full max-w-sm"},Be={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-green-300 shadow-xs rounded-md text-green-800 font-bold",title:"close",for:"banneralert"},Ce={key:1,class:"alert-banner fixed right-0 mt-8 w-2/3 md:w-full max-w-sm"},Le={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-red-200 shadow-xs rounded-md text-red-700 font-bold text-2xl border-2 border-red-500",title:"close",for:"banneralert"},je={key:2},ze={class:"w-full flex justify-center bg-blue-100 p-2 rounded-md"},Ve={key:3},Se={class:"w-full bg-blue-100 p-2 rounded-md"},Oe={class:"bg-blue-800 text-white text-xl text-center"},Ae=["value"],De={class:"w-full"},Ne={class:"w-full p-2"},Te={__name:"index",props:{stocks:Array,stock_items:Object,unit:Object,errors:Object,can:{type:Object,required:!0},stock_status:{type:String},filters:{type:Object}},setup(s){let c=b(s.filters.search);const d=j({filter_key:"",stock_id:B().props.auth.user.unitid?B().props.auth.user.unitid:0});A(c,a=>{D.get(route("stock"),{search:a},{preserveState:!0,replace:!0})});const f=(()=>{d.get(route("stock"),{preserveState:!0,preserveScroll:!0})});return(a,l)=>(r(),N(F,null,{default:h(()=>[a.$page.props.flash.status==="success"?(r(),n("div",$e,[l[4]||(l[4]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",Be,[m(o(a.$page.props.flash.msg)+" ",1),l[3]||(l[3]=e("svg",{class:"fill-current text-white",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):g("",!0),a.$page.props.flash.status==="error"?(r(),n("div",Ce,[l[6]||(l[6]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",Le,[m(o(a.$page.props.flash.msg)+" ",1),l[5]||(l[5]=e("svg",{class:"fill-current text-red-700 w-8 h-8",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):g("",!0),s.stock_status==="close"?(r(),n("div",je,[e("div",ze," คลัง"+o(a.$page.props.auth.user.profile.division_name)+" ถูกปิดการใช้งาน ",1)])):(r(),n("div",Ve,[e("div",Se,[e("div",Oe,o(a.$page.props.unit.unitname),1),l[7]||(l[7]=e("div",{class:"mt-3"},[e("label",{for:""},"เลือกคลังวัสดุ")],-1)),_(e("select",{name:"",id:"",class:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight focus:outline-hidden focus:shadow-outline","onUpdate:modelValue":l[0]||(l[0]=i=>u(d).stock_id=i),onChange:l[1]||(l[1]=i=>f())},[(r(!0),n(I,null,C(a.$page.props.stocks,i=>(r(),n("option",{key:i.id,value:i.id},o(i.stockname),9,Ae))),128))],544),[[E,u(d).stock_id]])]),e("div",De,[_(e("input",{type:"text",placeholder:"พิมพ์รหัสวัสดุ หรือชื่อวัสดุ หรือชื่อบริษัท ที่ต้องการค้นหา","onUpdate:modelValue":l[2]||(l[2]=i=>U(c)?c.value=i:c=i),class:"mt-2 border-green-600 border-2 block w-full shadow-xs sm:text-sm rounded-md"},null,512),[[M,u(c)]])]),l[8]||(l[8]=e("div",{class:"w-full flex mt-2 text-sm rounded-md"},[e("div",{class:"w-full flex"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-8 h-8 text-red-500"},[e("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})]),e("label",{for:""},"เตือนเมื่อวัสดุมีน้อยกว่า 6 ชิ้น ")])],-1)),e("div",Ne,[p(L,{pagination:s.stock_items},null,8,["pagination"]),(r(!0),n(I,null,C(s.stock_items.data,(i,y)=>(r(),n("div",{key:i.id,class:"m-2 p-2"},[p(Ie,{itemIndex:y,stockItem:i,canAbility:s.can},null,8,["itemIndex","stockItem","canAbility"])]))),128)),p(L,{pagination:s.stock_items},null,8,["pagination"])])]))]),_:1}))}};export{Te as default};
