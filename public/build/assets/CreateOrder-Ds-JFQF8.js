import{u as $,r as w,c as u,a as e,d as c,t as i,e as r,k as h,w as x,v as y,n as L,l as B,F as k,g as M,o as n,h as O,i as j,j as C,f as z,b as S,p as V}from"./app-3-81Xgwv.js";import{A as F}from"./AppLayout-CpSAxy21.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Navbar-SH8ePkG9.js";const N={class:"w-full p-2"},A={class:"w-full bg-indigo-100 border-2 border-indigo-300 mt-3 rounded-lg lg:max-w-full lg:flex lg:flex-col"},U={class:"flex ml-2"},I={class:"ml-2"},H={class:"ml-2 text-red-600"},P={class:"inline-flex px-2 text-lg font-semibold leading-5 rounded-full"},q={class:"flex ml-6"},E={class:"flex justify-end w-1/4 py-2 px-2"},D={key:0,class:"text-red-600"},T={class:"w-3/4"},G={class:"flex ml-6"},J={class:"w-3/4"},K={class:"flex ml-6"},Q={class:"w-3/4"},R={class:"flex ml-6"},W={class:"w-3/4"},X={class:"flex ml-6 mt-2"},Y={class:"flex justify-end w-1/4 py-2 px-2"},Z={key:0,class:"text-red-600"},ee={class:"w-3/4"},te=["value"],se={__name:"OrderItem",props:{businesses:{type:Object,required:!0},itemIndex:{type:Number,required:!0},itemStock:{type:Object,required:!0}},emits:["previewOrder"],setup(m,{emit:b}){const g=b,p=m,s=$({item:[],business_input:[],order_input:0,preview_orders:Array});s.item=p.itemStock;const _=w(0),f=w(!1),v=w(!1),a=w(""),l=()=>{if(s.order_input==0)return v.value=!0,a.value="กรุณาระบุจำนวนสั่งซื้อ",!1;if(v.value=!1,s.business_input.length==0)return f.value=!0,a.value="กรุณาระบุบริษัทผู้ขาย",!1;f.value=!1;const o=s.business_input.split("-");s.preview_orders=[],_.value=s.order_input*s.item.price;let t=_.value.toFixed(2);s.preview_orders.push({stock_id:s.item.stock_id,id:s.item.id,sap:s.item.item_code,item_name:s.item.item_name,order_input:s.order_input,price:s.item.price,business_id:o[0],business_name:o[1],total:t,catalog_number:s.item.checkin_last.profile.catalog_number,lot_number:s.item.checkin_last.profile.lot_number}),g("previewOrder",s.preview_orders)};return(o,t)=>(n(),u("div",N,[e("div",A,[e("div",U,[c(i(m.itemIndex+1)+". ",1),e("p",I,i(r(s).item.item_code)+":"+i(r(s).item.item_name),1),e("p",H,[e("span",P,[t[5]||(t[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)),c(" "+i(r(s).item.item_sum),1)])])]),e("div",q,[e("div",E,[v.value?(n(),u("div",D,[...t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)])])):h("",!0),t[7]||(t[7]=e("div",null," จำนวนสั่งซื้อ:",-1))]),e("div",T,[x(e("input",{type:"number",placeholder:"จำนวนสั่งซื้อ",class:L(["block w-full mt-1 rounded-md",[v.value?"border-red-500 border-2 ":"border-gray-400"]]),"onUpdate:modelValue":t[0]||(t[0]=d=>r(s).order_input=d)},null,2),[[y,r(s).order_input]])])]),e("div",G,[t[8]||(t[8]=e("div",{class:"w-1/4 py-2 px-2 text-right"}," Cat.No:",-1)),e("div",J,[x(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=d=>r(s).item.checkin_last.profile.catalog_number=d),class:"block w-full mt-1 border-gray-400 rounded-md"},null,512),[[y,r(s).item.checkin_last.profile.catalog_number]])])]),e("div",K,[t[9]||(t[9]=e("div",{class:"w-1/4 py-2 px-2 text-right"}," Lot.No:",-1)),e("div",Q,[x(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=d=>r(s).item.checkin_last.profile.lot_number=d),class:"block w-full mt-1 border-gray-400 rounded-md"},null,512),[[y,r(s).item.checkin_last.profile.lot_number]])])]),e("div",R,[t[10]||(t[10]=e("div",{class:"w-1/4 py-2 px-2 text-right"}," ราคาต่อหน่วย:",-1)),e("div",W,[x(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=d=>r(s).item.price=d),class:"block w-full mt-1 border-gray-400 rounded-md"},null,512),[[y,r(s).item.price]])])]),e("div",X,[e("div",Y,[f.value?(n(),u("div",Z,[...t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)])])):h("",!0),t[12]||(t[12]=e("div",null," บริษัทผู้ขาย:",-1))]),e("div",ee,[x(e("select",{id:"business_input",class:L(["block appearance-none w-full bg-white border hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight",[f.value?"border-red-500 border-2 ":"border-gray-400"]]),"onUpdate:modelValue":t[4]||(t[4]=d=>r(s).business_input=d)},[(n(!0),u(k,null,M(m.businesses,d=>(n(),u("option",{key:d.id,value:d.id+"-"+d.business_name},i(d.business_name),9,te))),128))],2),[[B,r(s).business_input]])])]),e("div",{class:"m-2"},[e("button",{class:"w-full flex justify-center text-sm text-white bg-blue-600 rounded-md hover:bg-blue-400 focus:outline-hidden",onClick:l},[...t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})],-1),c(" ใส่ตะกร้า ",-1)])])])])]))}},le={key:0,class:"alert-banner fixed right-0 m-2 w-5/6 md:w-full max-w-sm"},oe={class:"close cursor-pointer flex items-center justify-between w-full p-2 bg-green-300 shadow-xs rounded-md text-green-800 font-bold",title:"close",for:"banneralert"},re={class:"w-full bg-blue-100 p-2 rounded-md"},ie={class:"bg-blue-800 text-white text-xl text-center"},ne=["value"],de={class:"m-3 text-center text-lg font-bold"},ae={class:"flex text-right px-6 justify-end"},ue={class:""},pe={key:1,class:"alert-banner fixed z-20 top-60 ml-10 shadow-lg w-3/4 lg:ml-96 lg:w-2/5"},me={for:"",class:"flex items-start justify-between w-full p-1 bg-yellow-100 shadow-lg text-yellow-800 font-bold"},xe={__name:"CreateOrder",props:{stocks:Array,stock_items:Array,unit:Object,businesses:Array,sysdate_thai:String,sysdate:String},setup(m){const b=w(!1);w(0);const g=w(0),p=$({preview_orders:[],unit_id:0});O(()=>{p.items=j().props.stock_items,p.unit_id=j().props.unit.unitid});const s=a=>{p.preview_orders.push(a)},_=()=>{b.value=!0,g.value=0;let a=0,l=0;p.preview_orders.forEach(o=>{a=parseFloat(o[0].total),l=l+a}),g.value=l.toFixed(2)},f=()=>{b.value=!1},v=(()=>{p.post(route("add-order"),{preserveState:!1,preserveScroll:!0,onSuccess:a=>{console.log("success")},onError:a=>{console.log("error")},onFinish:a=>{console.log("finish")}})});return(a,l)=>(n(),C(F,null,{default:z(()=>[a.$page.props.flash.status=="success"?(n(),u("div",le,[l[3]||(l[3]=e("input",{type:"checkbox",class:"hidden",id:"banneralert"},null,-1)),e("label",oe,[c(i(a.$page.props.flash.msg)+" ",1),l[2]||(l[2]=e("svg",{class:"fill-current text-white",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 18 18"},[e("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1))])])):h("",!0),e("div",re,[e("div",ie,i(m.unit.unitname),1),l[4]||(l[4]=e("div",{class:"mt-3"},[e("label",{for:""},"เลือกคลังวัสดุ")],-1)),x(e("select",{name:"",id:"",class:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-2 py-2 pr-6 rounded-xs shadow-xs leading-tight focus:outline-hidden focus:shadow-outline","onUpdate:modelValue":l[0]||(l[0]=o=>r(p).unit_id=o)},[(n(!0),u(k,null,M(m.stocks,o=>(n(),u("option",{key:o.id,value:o.id},i(o.stockname),9,ne))),128))],512),[[B,r(p).unit_id]])]),l[9]||(l[9]=e("h1",{class:"m-3 text-center text-lg font-bold"},"สร้างเอกสารใบสัญญาสั่งซื้อวัสดุ ",-1)),e("h1",de,"ข้อมูลจำนวนคงเหลือ ณ วันที่ปัจจุบัน "+i(m.sysdate_thai),1),e("div",ae,[l[5]||(l[5]=e("div",{class:"flex"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",ue,[r(p).preview_orders.length>0?(n(),u("button",{key:0,class:"transition duration-500 ease-in-out bg-red-600 hover:bg-red-400 transform hover:-translate-y-1 hover:scale-110 inline-flex px-2 text-lg font-semibold leading-5 text-white rounded-full",onClick:_},i(r(p).preview_orders.length),1)):h("",!0)])]),r(b)?(n(),u("div",pe,[l[8]||(l[8]=e("label",{for:"previeworder",class:"flex items-start justify-between w-full p-1 bg-yellow-200 shadow-lg text-yellow-900 font-bold",title:"close"},[c(" รายการวัสดุที่ต้องการสั่งซื้อ "),e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 cursor-pointer",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("input",{type:"checkbox",class:"hidden",id:"previeworder",onClick:f}),(n(!0),u(k,null,M(r(p).preview_orders,(o,t)=>(n(),u("label",{key:o.id,class:"close cursor-pointer flex items-start justify-between w-full pt-4 px-2 bg-yellow-100 shadow-lg text-sm text-yellow-900",title:"close",for:"previeworder"},[c(i(t+1)+"."+i(o[0].item_name)+" จำนวน "+i(o[0].order_input)+" x "+i(o[0].price)+" เป็นเงิน "+i(o[0].total)+" บาท ",1),S(r(V),{class:"ml-4 px-2 text-red-800 font-bold bg-red-300 rounded-md"},{default:z(()=>[...l[6]||(l[6]=[c("ลบ",-1)])]),_:1})]))),128)),e("label",me," รวม "+i(r(g))+" บาท ",1),e("button",{class:"w-full flex justify-center py-2 text-sm text-yellow-900 font-bold bg-yellow-300 hover:bg-yellow-200 focus:outline-hidden",onClick:l[1]||(l[1]=o=>v())},[...l[7]||(l[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})],-1),c(" สร้างใบสั่งซื้อ ",-1)])])])):h("",!0),(n(!0),u(k,null,M(m.stock_items,(o,t)=>(n(),C(se,{key:o.id,itemIndex:t,itemStock:o,businesses:m.businesses,onPreviewOrder:s},null,8,["itemIndex","itemStock","businesses"]))),128))]),_:1}))}};export{xe as default};
